{% load i18n %}


<script type="text/javascript">
    $('#main-content').addClass("search_form_enabled_territory");
</script>

<div id="territory_top_search"></div>
<div id="search_form">
    {% include search_form_template %}
</div>


<div id="territory_top"></div>
<div id="result_territory">

<div class="territory_pagination_top pagination_top pagination">
    {% include "page_coop_territory/pagination.html" %}
    <div class="carto"><a href="javascript:submitForm('{{ base_url }}p/carto')">{% trans "Cartography" %}</a></div>
</div>


{% for item in items %}

    {% if item.type == 'exchange' %}
        <div class="coop_territory">
            <div class="bloc_title">
                {% if item.obj.img  %}
                    <div class="logo"><a class="territory_link" href="{{ base_url }}p/{{ item.obj.pk }}"><img src="{{ media_path }}{{ item.obj.img }}" alt="{{ item.obj.title }}"></a></div>
                {% else %}
                    <div class="logo logo_pes"></div>
                {% endif %}

                <div class="resume">
                    {% if item.obj.location == None %} {% else %} <span class="location">{{ item.obj.location|truncatechars:20 }}</span> {% endif %}
                    <div class="exchange_type">{% trans "Type" %} : {{ item.obj.get_eway_display }}</div>
                    <a href="{{ exchanges_url }}p/{{ item.obj.pk }}"><h3 class="exchange_title resume_title">{{ item.obj.title }}</h3></a>
                    <div class="exchange_desc">{{ item.obj.description|safe|truncatechars:150 }}</div>
                    <span class="readmore"><a class="territory_link" href="{{ exchanges_url }}p/{{ item.obj.pk }}">{% trans "Read more" %}</a></span>
                </div>
            </div>
        </div>
    {% endif %}

    {% if item.type == 'occ' %}
        <div class="coop_territory">
            <div class="bloc_title">
                {% if item.obj.img  %}
                    <div class="logo"><a class="territory_link" href="{{ base_url }}p/{{ item.obj.pk }}"><img src="{{ media_path }}{{ item.obj.img }}" alt="{{ item.obj.title }}"></a></div>
                {% else %}
                    <div class="logo logo_pes"></div>
                {% endif %}

                <div class="resume">
                    {% if item.obj.location == None %} {% else %} <span class="location">{{ item.obj.location|truncatechars:20 }}</span> {% endif %}
                    <div class="exchange_type">{% trans "Type" %} : {{ item.obj.get_eway_display }}</div>
                    <a href="{{ agenda_url }}p/{{ item.obj.pk }}"><h3 class="exchange_title resume_title">{{ item.obj.title }}</h3></a>
                    <div class="exchange_desc">{{ item.obj.description|safe|truncatechars:150 }}</div>
                    <span class="readmore"><a class="territory_link" href="{{ agenda_url }}p/{{ item.obj.pk }}">{% trans "Read more" %}</a></span>
                </div>
            </div>
        </div>
    {% endif %}


    {% if item.type == 'news' %}
        <div class="coop_territory">
            <div class="bloc_title">
                {% if item.obj.img  %}
                    <div class="logo"><a class="territory_link" href="{{ base_url }}p/{{ item.obj.pk }}"><img src="{{ media_path }}{{ item.obj.img }}" alt="{{ item.obj.title }}"></a></div>
                {% else %}
                    <div class="logo logo_pes"></div>
                {% endif %}

                <div class="resume">
                    {% if item.obj.location == None %} {% else %} <span class="location">{{ item.obj.location|truncatechars:20 }}</span> {% endif %}
                    <div class="exchange_type">{% trans "Type" %} : {{ item.obj.get_eway_display }}</div>
                    <a href="{{ blog_url }}p/{{ item.obj.pk }}"><h3 class="exchange_title resume_title">{{ item.obj.title }}</h3></a>
                    <div class="exchange_desc">{{ item.obj.description|safe|truncatechars:150 }}</div>
                    <span class="readmore"><a class="territory_link" href="{{ blog_url }}p/{{ item.obj.pk }}">{% trans "Read more" %}</a></span>
                </div>
            </div>
        </div>
    {% endif %}

    {% if item.type == 'organization' %}
        <div class="coop_territory">
            <div class="bloc_title">
                {% if item.obj.img  %}
                    <div class="logo"><a class="territory_link" href="{{ base_url }}p/{{ item.obj.pk }}"><img src="{{ media_path }}{{ item.obj.img }}" alt="{{ item.obj.title }}"></a></div>
                {% else %}
                    <div class="logo logo_pes"></div>
                {% endif %}

                <div class="resume">
                    {% if item.obj.location == None %} {% else %} <span class="location">{{ item.obj.location|truncatechars:20 }}</span> {% endif %}
                    <div class="exchange_type">{% trans "Type" %} : {{ item.obj.get_eway_display }}</div>
                    <a href="{{ organizations_url }}p/{{ item.obj.pk }}"><h3 class="exchange_title resume_title">{{ item.obj.title }}</h3></a>
                    <div class="exchange_desc">{{ item.obj.description|safe|truncatechars:150 }}</div>
                    <span class="readmore"><a class="territory_link" href="{{ organizations_url }}p/{{ item.obj.pk }}">{% trans "Read more" %}</a></span>
                </div>
            </div>
        </div>
    {% endif %}



{% endfor %}


<div class="territory_pagination_bottom pagination_bottom pagination">
    {% include "page_coop_territory/pagination.html" %}
</div>
</div>


<script type="text/javascript">
    $(document).ready(function() {
//         $("#id_location").autocomplete({
//             source: {{ available_locations|safe }},
//             select: function(e, ui) {
//                 e.preventDefault() // <--- Prevent the value from being inserted.
//                 $("#id_location_id").val(ui.item.value);
// 
//                 $(this).val(ui.item.label);
//             }
//         });
    });

    function submitForm(url) {
        document.forms["search-form"].action = url;
        document.forms["search-form"].submit();
    }

</script>



